<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <script src="javascripts/prototype.js" type="text/javascript" charset="utf-8"></script>
    <script src="javascripts/letters.js" type="text/javascript" charset="utf-8"></script>
    <script src="javascripts/plumb.js" type="text/javascript" charset="utf-8"></script>
    <link rel="stylesheet" href="stylesheets/screen.css" type="text/css" media="screen" charset="utf-8">
  </head>
  <body>
    
    <div id="top">
<h1>||)) ||   || || ||~||~|| ||))
||   ||__ ||_|| || || || ||))</h1>

      <p>“Plumb” is a tool for drawing web layouts that figures out HTML and CSS from shapes you draw. Static and liquid layouts are supported.</p>
      
      <p>An quick intro to Plumb can be found <a href="#bottom">below</a>.</p>
      
      <p>Plumb is <b>fairly experimental</b> and generates more markup than necessary in some cases. An small apology to Internet Explorer users – Plumb hasn’t been tested on <b>any</b> version of that browser yet. If you find a bug or find Plumb useful, <a href="mailto:michael@mdaines.com">tell me about it!</a></p>
      
      <p>Plumb was created by <a href="http://mdaines.com">Michael Daines</a>. The project is hosted <a href="http://github.com/mdaines/plumb">at github</a>.</p>
      
  </div>
    
  <div id="middle">
    
    <div id="toolbar">
      <div class="group modes">
        <div class="select button"><img src="images/select.gif"></div>
        <div class="draw button"><img src="images/draw.gif"></div>
      </div>
      <div class="group buttons">
        <div class="stretchy button"><img src="images/spring.gif"></div>
      </div>
    </div>
    <div id="layout">
    </div>
    
    <button id="recognize">Recognize &amp; test</button>
    
    <div id="preview" style="display:none;" class="clearfix"></div>
    
    <button id="code">Get HTML &amp; CSS</button>
    
    <div id="code-output" style="display:none;"></div>
    
    <button id="debug">Get debugging info</button>
    
    <div id="debug-output" style="display:none;"></div>
  
  </div>
    
    <script type="text/javascript" charset="utf-8">
      
      Plumb.setup({
        layout: { element: "layout" },
        toolbar: { element: "toolbar" }
      });
      
      var LayoutTest = {
        start: function(event) {
          this.handleH = event.findElement(".handle-h");
          this.handleV = event.findElement(".handle-v");
          
          if (this.handleH || this.handleV) {
            this.measurements = {
              pointer: event.pointer(),
              width: this.handleH ? this.handleH.up("#preview").offsetWidth : null,
              height: this.handleV ? this.handleV.up(".box").offsetHeight : null
            }
            this.dragging = true;
            
            event.stop();
          }
        },
        
        drag: function(event) {
          if (this.dragging) {
            if (this.handleH)
              var dim = this.measurements.width - (this.measurements.pointer.x - event.pointer().x);
            else
              var dim = this.measurements.height - (this.measurements.pointer.y - event.pointer().y);
            
            if (dim < 25) dim = 25;
            
            if (this.handleH)
              this.handleH.up("#preview").setStyle({ width: dim + "px" });
            else
              this.handleV.up(".box").setStyle({ height: dim + "px" });
            
            event.stop();
          }
        },
        
        finish: function(event) {
          this.dragging = false;
        }
      }
      
      $("preview").observe("mousedown", function(e) { LayoutTest.start(e); });
      Event.observe(window, "mousemove", function(e) { LayoutTest.drag(e); });
      Event.observe(window, "mouseup", function(e) { LayoutTest.finish(e); });
      
      $("recognize").observe("click", function() {
        try {
          var spec = Plumb.Recognition.recognize();
          
          $("preview").immediateDescendants().invoke("remove");
          Plumb.Output.output(spec, $("preview"));
          
          $("preview").insert( new Element("div", { className: "handle-h" }) );
          
          $("preview").select(".box").each(function(box) {
            if (!box.hasClassName("spacing"))
              box.insert( new Element("div", { className: "handle-v" }) );
          });
          
          $("preview").show();
          
        } catch (e) {
          if (e == Plumb.UnsupportedLayout) {
            alert("Sorry, Plumb can't recognize layouts like that.");
          } else {
            throw e;
          }
        }
      });
      
      $("debug").observe("click", function() {
        try {
          $("debug-output").innerHTML = Object.toJSON(Plumb.Recognition.getShapes()).escapeHTML();
          
          $("debug-output").show();
          
        } catch (e) {
          if (e == Plumb.UnsupportedLayout) {
            alert("Sorry, Plumb can't recognize layouts like that.");
          } else {
            throw e;
          }
        }
      });
      
      $("code").observe("click", function() {
        try {
          var container = new Element("div");
          Plumb.Output.output(Plumb.Recognition.recognize(), container);
          
          var css = "";
          var html = "";
          
          function outputChildren(element, level) {
            if (Object.isUndefined(level))
              level = 0;
            
            element.immediateDescendants().each(function(child) {
              css += "#" + child.id + " {\n"
              
              $A(child.style).each(function(property) {
                if (property != "height")
                  css += "  " + property + ": " + child.style.getPropertyValue(property) + ";\n";
              });
              
              css += "}\n\n";
              
              html += "  ".times(level) + "<div id=\"" + child.id + "\"";
              
              if (child.className != "")
                html += " class=\"" + child.className
                
              html += "\">\n";
                
              outputChildren(child, level + 1);
              
              html += "  ".times(level) + "</div>\n";
            });
            
            if (element.hasClassName("box") && !element.hasClassName("spacing"))
              html += "  ".times(level) + "Lorem ipsum dolor\n";
          }
          
          outputChildren(container);
          
          $("code-output").innerHTML = ("~~ CSS ~~\n\n" + css + "\n~~ HTML ~~\n\n" + html).escapeHTML();
          
          $("code-output").show();
          
        } catch (e) {
          if (e == Plumb.UnsupportedLayout) {
            alert("Sorry, Plumb can't recognize layouts like that.");
          } else {
            throw e;
          }
        }
      });
      
    </script>
    
    <div id="bottom">
      <h3>The basics of Plumb</h3>
      
      <h4>Drawing layouts</h4>
      
      <p>Above that area with the vertical stripes, there’s a toolbar with buttons. The ones to the left work like most vector drawing programs: the arrow is for selecting boxes, the rectangle draws boxes. The one on the right switches boxes between being stretchy and not stretchy.</p>
      
      <p><img src="images/about/toolbar.gif"></p>
      
      <p>Those vertical stripes are guides for a vertical grid. Plumb constrains all the boxes you draw to a vertical grid.</p>
      
      <p>Here’s what the work area might look like after drawing some stuff. This is a pretty common layout for a blog, say. It has a stretchy content area on the left, a sidebar on the right, and stretchy header and footer boxes:</p>
      
      <p><img src="images/about/layout.gif"></p>
      
      <h4>Testing your layout</h4>
      
      <p>After you've drawn your layout, you test it. Click the “Recognize &amp; test” button below the work area. Here’s what we get:</p>
      
      <p><img src="images/about/preview.gif"></p>
      
      <p>The little black squares are handles for changing the size of stuff. The one on the right changes the size of the testing area, so you can see how a stretchy layout will respond to changes in the browser’s window size. If you drag it left, the stretchy boxes get smaller:</p>
      
      <p><img src="images/about/thinner.gif"></p>
      
      <p>If you drag one of the handles at the bottom of a box downwards, you can see what would happen if the amount of content inside that box changed:</p>
      
      <p><img src="images/about/taller.gif"></p>
      
      <h4>Blank space</h4>
      
      <p>If you draw a layout that has space between boxes, Plumb will fill in that space with boxes of its own:</p>
      
      <p><img src="images/about/spacing.gif"></p>
      
      <p>Spacing boxes are never stretchy. If you want the effect of stretchy spacing boxes, just draw your own stretchy spacing boxes.</p>
      
      <h4>Getting the code!</h4>
      
      <p>To get HTML &amp; CSS for the layout you’ve drawn, click on the “Get HTML &amp; CSS” button, and the code will appear below the button.</p>
      
      <h4>If something weird happens</h4>
      
      <p>If an error occurs, or something strange happens with your layout, try clicking on the “Get debugging info” button. Send me what appears below the button (if anything) via email and I’ll check it out. My email address is <a href="mailto:michael@mdaines.com">michael@mdaines.com</a>.</p>
    </div>
    
  </body>
</html>